<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Expires" content="0" />

        <title>RMD Renderer</title>

        <link rel="stylesheet" href="src/bootstrap/css/bootstrap.min.css" >
        <link rel="stylesheet" href="src/open-iconic/font/css/open-iconic-bootstrap.min.css" >
        <link href="src/styles.css" rel="stylesheet"/>

        <script src="src/bootstrap/js/jquery-3.3.1.min.js"></script>
        <script src="src/bootstrap/js/popper.min.js"></script>
        <script src="src/bootstrap/js/bootstrap.min.js"></script>
        <script src="src/bibtex_js.js"></script>
        <script src="src/classes.js"></script>
        <script src="src/main.js"></script>

    </head>

    <body>
        <div id="header_wrapper">
            <a href="#main" class="sr-only">Skip to main content</a>
            <header class="wrapper clearfix" role="banner" aria-label="header" id="header">
                <div class="container relative">
                    <div id="psu_icon_wrapper">
                        <div id="psu_text_overlay">
                            <a href="http://psu.edu" title="The Pennsylvania State University" class="psu-link">Penn State</a>
                        </div>
                        <img alt="Penn State University" title="Penn State University" src="src/psu_logo.png">
                    </div>
                    <div id="title_wrapper" class="text-center">
                        <h1 class="title">RMD Renderer</h1>
                    </div>
                </div>
            </header>
            <nav id="topnav" role="navigation" aria-label="primary navigation">
                <ul id="topnavul" role="menubar">
                    <li class="active"><a href="/">Home</a></li>
                    <li><a href="about.html">About</a></li>
                </ul>
            </nav>
        </div>

        <main id="main">
        <div class="container margin_top">
            <h2>Render some RMarkdown</h2>

            <div id="input">
                <p>Type some Markdown or RMarkdown in the text box, choose your output filename and the file types.</p>
                <p>This system requires JavaScript.</p>
                <div>
                    <p class="form-group"><label for="rmd_name">File name</label><input type="text" id="rmd_name" class="form-control" value="MyFile"></p>
                    <p class="text-center"><button class="btn btn-primary" id="advanced_options_trigger">Show Advanced Options</button></p>

                    <div class="form-group hidden" id="advanced_options_wrapper">
                        <div>
                            <h3>Custom Header</h3>
                            <p>Add any header information you want here. Some defaults are provided to give you the idea</p>
                            <div class="margin_bottom row cust_header_row">
                                <div class="col-md-2"><input type="text" aria-label="Header Label" id="cust_header_key_0" class="form-control header_key" placeholder="Label" value="title"></div>
                                <div class="col-md-9"><input type="text" id="cust_header_val_0" class="margin_lr form-control header_val" placeholder="Text" value=""></div>
                                <div class="col-md-1"><button class="btn btn-secondary cust_header_del_trigger"><i title="Delete" class="oi oi-trash" aria-hidden="true"></i><span class="sr-only">Delete this header</span></div>
                            </div>
                            <div class="margin_bottom row cust_header_row">
                                <div class="col-md-2"><input type="text" aria-label="Header Label" id="cust_header_key_1" class="form-control header_key" placeholder="Label" value="author"></div>
                                <div class="col-md-9"><input type="text" id="cust_header_val_1" class="margin_lr form-control header_val" placeholder="Text" value=""></div>
                                <div class="col-md-1"><button class="btn btn-secondary cust_header_del_trigger"><i title="Delete" class="oi oi-trash" aria-hidden="true"></i><span class="sr-only">Delete this header</span></div>
                            </div>
                            <div class="margin_bottom row cust_header_row">
                                <div class="col-md-2"><input type="text" aria-label="Header Label" id="cust_header_key_2" class="form-control header_key" placeholder="Label" value="date"></div>
                                <div class="col-md-9"><input type="text" id="cust_header_val_2" class="margin_lr form-control header_val" placeholder="Text" value=""></div>
                                <div class="col-md-1"><button class="btn btn-secondary cust_header_del_trigger"><i title="Delete" class="oi oi-trash" aria-hidden="true"></i><span class="sr-only">Delete this header</span></div>
                            </div>
                            <div class="margin_bottom row cust_header_row">
                                <div class="col-md-2"><input type="text" aria-label="Header Label" id="cust_header_key_3" class="form-control header_key" placeholder="Label" value=""></div>
                                <div class="col-md-9"><input type="text" id="cust_header_val_3" class="margin_lr form-control header_val" placeholder="Text" value=""></div>
                                <div class="col-md-1"><button class="btn btn-secondary cust_header_del_trigger"><i title="Delete" class="oi oi-trash" aria-hidden="true"></i><span class="sr-only">Delete this header</span></div>
                            </div>
                            <div id="cust_header_template" class="margin_bottom row hidden">
                                <div class="col-md-2"><input type="text" aria-label="Header Label" class="form-control header_key" placeholder="Label" value=""></div>
                                <div class="col-md-9"><input type="text" class="margin_lr form-control header_val" placeholder="Text" value=""></div>
                                <div class="col-md-1"><button class="btn btn-secondary cust_header_del_trigger"><i title="Delete" class="oi oi-trash" aria-hidden="true"></i><span class="sr-only">Delete this header</span></div>
                            </div>
                            <div id="cust_header_new_wrapper" class="text-center margin_bottom">
                                <button class="btn btn-success" id="cust_header_new_trigger">New Header Item<i class="margin_left oi oi-plus" aria-hidden="true"></i></button>
                            </div>
                        </div>
                        <div>
                            <h3>BibTex citiations</h3>
                            <p>Add a set of BibTex citations to be able to be used in the main text area below.</p>
                            <p><button type="button" class="btn btn-primary" id="bibtex_popup_trigger" data-toggle="modal" data-target="#bibtex_modal">Update BibTex</button></p>
                        </div>
                    </div> <!-- end advanced options //-->

                    <div class="text-center">
                    <div class="btn-group margin_bottom" id="edit_menu" role="group" aria-label="insert and edit options">
                    </div>
                    </div>

                    <p><label for="rmd_text">Main file contents</label></p>
                    <p><textarea id="rmd_text"># Here's a heading
*** this is some bold text ***
Here's some R code:
```{r}
Sys.time()
```
                    </textarea></p>
                </div>
                <div class="inline_divs">
                    <p>Create which files?</p>
                    <div class="col-sm-2"><label for="choice_html">html</label><input type="checkbox" class="format_choice margin_lr" id="choice_html" checked></div>
                    <div class="col-sm-2"><label for="choice_docx">docx</label><input type="checkbox" class="format_choice margin_lr" id="choice_docx"></div>
                    <div class="col-sm-2"><label for="choice_pdf">pdf</label><input type="checkbox" class="format_choice margin_lr" id="choice_pdf"></div>
                    <!--<div class="col-sm-2"><label for="choice_pptx">pptx</label><input type="checkbox" class="format_choice margin_lr" id="choice_pptx"></div>//-->
                </div>
                <div class="clearfix"></div>
                <p class="text-center"><button class="btn btn-primary" id="main_submit">Submit</button></p>
            </div>

            <div id="live_sr" aria-live="polite" class="sr-only">
                Any messages will be displayed here.
            </div>
            <div id="live_visual" aria-hidden="true">
                Any messages will be displayed here.
            </div>
            <div id="output">
            </div>
            <div id="system_message">
            </div>

            <div id="live_sr_search" aria-live="polite" class="sr-only" aria-atomic="true">
            </div>
            <div id="search_storage" class="hidden">
            </div>

        </div>
        </main>
        <div class="modal fade" id="bibtex_modal" tabindex="-1" role="dialog" aria-labelledby="bibtex_modal_title" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="bibtex_modal_title">Update Bibtex</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p class="alert alert-secondary" role="alert"><button role="button" data-toggle="collapse" data-target="#bibtex_explanation" aria-expanded="false" aria-controls="bibtex_explanation" title="What is BibTex and how would it be used?" class="invis_button">What is BibTex and how would it be used?</button></p>
                        <div class="collapse" id="bibtex_explanation">
                            <div class="jumbotron">
                                <p><a href="http://www.bibtex.org/" target="_blank">BibTex</a> is tool for managing references. Raw BibTex is text that contains information about one or more specific references, and is used here to more easily cite references in the main text area.</p>
                                <p>The way this works is to first add or update the text to be used (or by uploading a file) by using the interface on this dialog window. From there, the system will remember the set of references and they will be available for use. When typing in the main text area (the area labeled as Main file contents), you can hit Alt + Shift + R or use the menu above to add a reference. This will bring up an interface to choose the reference wanted from the available list, and insert it. </p>
                                <p>After inserting a reference, the text will look something like this:</p>
                                <div class="card card-body">
                                    <p>Some text some text some text [@reference]</p>
                                </div>
                                <p>This will come out in the final rendered documents depending on the format, but will look something like:</p>
                                <div class="card card-body">
                                    <p>Some text some text some text (Referenced Author, 211-215)</p>
                                </div>
                                <p>Note that square brackets should be used here to properly create the citation.</p>
                            </div>
                        </div> <!-- end explanation //-->
                        <div>
                            <div class="form-group">
                                <label for="bibtex_upload_file">Upload a BibTex file (.bib or .bibtex)</label>
                                <input type="file" class="form-control-file" id="bibtex_upload_file">
                            </div>
                            <div>
                                <ul id="bib_list" class="list-group margin_bottom">
                                    <li id="bib_list_template" class="hidden list-group-item"><span class="bib_filename">myfile.txt</span> <span class="bib_file_length badge badge-primary"></span><button class="btn btn-sm btn-secondary bib_delete margin_lr float-right" role="button"><i class="oi oi-trash" aria-hidden="true" title="Delete this file"></i><span class="sr-only"> Delete this file</span></button></li>
                                </ul>
                            </div>
                            <div class="form-group">
                                <label for="bibtex_textarea">Add BibTex manually</label>
                                <textarea class="form-control" id="bibtex_textarea"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div> <!-- end bibtex_modal //-->
        <div class="modal fade" id="citation_modal" tabindex="-1" role="dialog" aria-labelledby="citation_modal_title" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="citation_modal_title">Insert Citation</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="input-group mb-3">
                            <input type="text" class="form-control" aria-label="Filter reference list" placeholder="Filter" id="citation_filter">
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary" type="button" id="citation_clear_filter" title="Clear Filter"><i class="oi oi-x" aria-hidden="true"></i><span class="sr-only"> Clear Filter</span></button>
                            </div>
                        </div>
                        <div>
                            <ul class="list-group" id="citation_list">
                                <li class="list-group-item">No references found, try adding some first.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div> <!-- end citation_modal //-->
        <div class="modal fade" id="error_modal" tabindex="-1" role="dialog" aria-labelledby="error_modal_title" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="error_modal_title">Error</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div> <!-- end citation_modal //-->
    </body>
</html>

